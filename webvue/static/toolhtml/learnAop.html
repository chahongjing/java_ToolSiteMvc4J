<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<title>学习AOP</title>
	<link rel='stylesheet' type='text/css' href='../bootstrap/css/bootstrap.min.css'>
	<link rel='stylesheet' type='text/css' href='../css/common.css'>
</head>

<body class='elearn'>
	<h2>AOP方式</h2>
	<ul class="list">
		<li>静态代理：aspectj。会在编译阶段将Aspect织入Java字节码中， 运行的时候就是经过增强之后的AOP对象。它需要特定的编译器进行处理</li>
		<li>动态代理：如spring
			AOP，他有两种实现方式：JDKProxy和Cglib，具体使用哪种方式生成由AopProxyFactory根据AdvisedSupport对象的配置来决定。默认的策略是如果目标类是接口，则使用JDK动态代理技术，否则使用Cglib来生成代理。AOP框架不会去修改字节码，而是在内存中临时为方法生成一个AOP对象，这个AOP对象包含了目标对象的全部方法，并且在特定的切点做了增强处理，并回调原对象的方法</li>
	</ul>
	<hr>
	<h2>代理模式<a href="/test/testProxy.do" target="_blank">测试代理</a></h2>
	<ul class='list'>
		<li>切面（aspect）</li>
		<li>通知（advice）</li>
		<li>目标（target）</li>
		<li>代理（proxy）</li>
		<li>连接点（joinpoint）</li>
		<li>切点（pointcut）</li>
	</ul>
	<hr>

	<h2>AspectJ<a href="/test/testAspectJ.do" target="_blank">测试AspectJ</a></h2>
	<ul class='list'>
		<li>@Before前置通知，方法执行前</li>
		<li>@After后置通知，方法执行后, 无论是否发生异常，都会执行</li>
		<li>@AfterReturning返回通知，方法正常结束后执行</li>
		<li>@AfterThrowing异常通知，抛出异常后执行</li>
		<li>@Around环绕通知，围绕方法执行</li>
	</ul>
	<p>可使用@Order(3)指定切面优先级，值越小，优先级越高，越先执行</p>
	<hr>
	<h2>基于xml配置文件的配置，此时切面中不需要任何注解，包括@Aspect, @Before等</h2>
	<ul class='list'>
		<li>在配置文件中配置切面bean, 如<br>&lt;bean id="loggingAspect" class="com.zjy.bll.common.LoggingAspect"&gt;&lt;/bean&gt;
		</li>
		<li>配置aop<br>
			&lt;aop:config&gt;<br>
			&nbsp;&nbsp;&lt;!-- 配置切点表达式 --&gt;<br>
			&nbsp;&nbsp;&lt;aop:pointcut expression="execution(* com.zjy.bll.service.*.*(..))"
			id="pointcut"&gt;&lt;/aop:pointcut&gt;<br>
			&nbsp;&nbsp;&lt;aop:aspect ref="loggingAspect" order="2"&gt;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&lt;aop:before method="beforeMethod" pointcut-ref="pointcut"&gt;&lt;/aop:before&gt;<br>
			&nbsp;&nbsp;&nbsp;&nbsp;&lt;aop:after-throwing method="afterThrowing" pointcut-ref="pointcut"
			throwing="ex"&gt;&lt;/aop:after-throwing&gt;<br>
			&nbsp;&nbsp;&lt;/aop:aspect&gt;
			&lt;/aop:config&gt;<br>
		</li>
	</ul>
</body>
</html>